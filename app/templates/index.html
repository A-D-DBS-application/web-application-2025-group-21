{% extends "base.html" %}
{% block title %}Home | IConsult{% endblock %}

{% block content %}

<div class="home-hero">
    <h1>IConsult</h1>
    <p class="home-subtitle">
        Het platform waar <strong>consultants</strong> en <strong>bedrijven</strong> elkaar vinden
        via een slimme, transparante matchscore.
    </p>

    <div class="home-cta-row">
        {% if session.get('user_id') %}
            {% if session.get('role') == 'company' %}
                <a href="{{ url_for('main.consultants_list') }}" class="home-btn primary">
                    üëâ Zoek consultants
                </a>
                <a href="{{ url_for('main.company_jobs_list') }}" class="home-btn secondary">
                    Mijn vacatures
                </a>
            {% elif session.get('role') == 'consultant' %}
                <a href="{{ url_for('main.jobs_list') }}" class="home-btn primary">
                    üëâ Bekijk vacatures
                </a>
                <a href="{{ url_for('main.dashboard') }}" class="home-btn secondary">
                    Mijn profiel
                </a>
            {% else %}
                <a href="{{ url_for('main.dashboard') }}" class="home-btn primary">
                    üëâ Ga naar je dashboard
                </a>
            {% endif %}
        {% else %}
            <a href="{{ url_for('main.login') }}" class="home-btn primary">
                üëâ Log in om te starten
            </a>
            <p class="home-small">
                Nog geen account? Kies je rol op de loginpagina ‚Äì consultant of bedrijf.
            </p>
        {% endif %}
    </div>
</div>

{# METRICS BLIJVEN ALGEMEEN #}
<div class="home-metrics">
    <div class="metric-card">
        <span class="metric-label">Actieve vacatures</span>
        <span class="metric-value">
            {% if latest_jobs %}
                {{ latest_jobs|length }}
            {% else %}
                10+
            {% endif %}
        </span>
        <span class="metric-hint">Gericht op digitale & zakelijke profielen</span>
    </div>
    <div class="metric-card">
        <span class="metric-label">Beschikbare consultants</span>
        <span class="metric-value">
            {% if latest_consultants %}
                {{ latest_consultants|length }}
            {% else %}
                20+
            {% endif %}
        </span>
        <span class="metric-hint">Met duidelijke skill-profielen</span>
    </div>
    <div class="metric-card">
        <span class="metric-label">Matchmotor</span>
        <span class="metric-value">IConsult</span>
        <span class="metric-hint">Skills, tekst, recentheid & populariteit</span>
    </div>
</div>

{# ROLSPECIFIEKE INFO-BLOKKEN #}
<div class="home-columns">

    {# NIET INGELOGD ‚Üí BEIDE #}
    {% if not session.get('user_id') %}
        <div class="home-column">
            <h2>Voor bedrijven</h2>
            <ul>
                <li>Maak snel een vacature aan met vereiste skills.</li>
                <li>Ontvang een gesorteerde lijst consultants volgens matchscore.</li>
                <li>Unlock contactgegevens alleen wanneer het relevant is.</li>
            </ul>
        </div>

        <div class="home-column">
            <h2>Voor consultants</h2>
            <ul>
                <li>Vul je profiel en skills in voor betere matches.</li>
                <li>Ontdek vacatures die echt passen bij jouw expertise.</li>
                <li>Jij kiest wanneer je je gegevens vrijgeeft aan een bedrijf.</li>
            </ul>
        </div>

    {# COMPANY ‚Üí ENKEL BEDRIJVEN #}
    {% elif session.get('role') == 'company' %}
        <div class="home-column">
            <h2>Voor bedrijven</h2>
            <ul>
                <li>Maak snel een vacature aan met vereiste skills.</li>
                <li>Ontvang een gesorteerde lijst consultants volgens matchscore.</li>
                <li>Unlock contactgegevens alleen wanneer het relevant is.</li>
            </ul>
            <a href="{{ url_for('main.job_new') }}" class="home-link">
                + Nieuwe vacature aanmaken
            </a>
        </div>

    {# CONSULTANT ‚Üí ENKEL CONSULTANTS #}
    {% elif session.get('role') == 'consultant' %}
        <div class="home-column">
            <h2>Voor consultants</h2>
            <ul>
                <li>Vul je skills en specialisatie zo volledig mogelijk in.</li>
                <li>Ontdek vacatures die echt passen bij jouw expertise.</li>
                <li>Je kiest zelf wanneer je je gegevens vrijgeeft.</li>
            </ul>
            <a href="{{ url_for('main.edit_consultant_profile') }}" class="home-link">
                ‚úèÔ∏è Werk mijn profiel bij
            </a>
        </div>
    {% endif %}
</div>

{# ROLSPECIFIEKE ‚ÄúRECENT‚Äù LIJSTEN #}

{# NIET INGELOGD ‚Üí BEIDE LIJSTEN #}
{% if not session.get('user_id') %}
    {% if latest_jobs %}
    <section class="home-list-section">
        <h2>Recent toegevoegde vacatures</h2>
        <div class="home-list-grid">
            {% for job in latest_jobs %}
                <article class="mini-card">
                    <h3>
                        <a href="{{ url_for('main.job_detail', job_id=job.id) }}">
                            {{ job.title }}
                        </a>
                    </h3>
                    {% if job.company %}
                        <p class="mini-meta">{{ job.company.company_name_masked }}</p>
                    {% endif %}
                    <p class="mini-location">
                        {% if job.location_city or job.country %}
                            <i class="fas fa-map-marker-alt"></i>
                            {{ job.location_city }}{% if job.location_city and job.country %}, {% endif %}{{ job.country }}
                        {% else %}
                            &nbsp;
                        {% endif %}
                    </p>
                </article>
            {% endfor %}
        </div>
    </section>
    {% endif %}

    {% if latest_consultants %}
    <section class="home-list-section">
        <h2>Nieuwe consultants</h2>
        <div class="home-list-grid">
            {% for c in latest_consultants %}
                <article class="mini-card">
                    <h3>
                        <a href="{{ url_for('main.consultant_detail', profile_id=c.id) }}">
                            {{ c.display_name or c.display_name_masked }}
                        </a>
                    </h3>
                    <p class="mini-meta">
                        {% if c.specialisation %}{{ c.specialisation }}{% endif %}
                    </p>
                    <p class="mini-location">
                        {% if c.location_city or c.country %}
                            <i class="fas fa-map-marker-alt"></i>
                            {{ c.location_city }}{% if c.location_city and c.country %}, {% endif %}{{ c.country }}
                        {% else %}
                            &nbsp;
                        {% endif %}
                    </p>
                </article>
            {% endfor %}
        </div>
    </section>
    {% endif %}
{% else %}

    {# COMPANY ‚Üí vooral recent CONSULTANTS tonen #}
    {% if session.get('role') == 'company' and latest_consultants %}
    <section class="home-list-section">
        <h2>Nieuwe consultants</h2>
        <div class="home-list-grid">
            {% for c in latest_consultants %}
                <article class="mini-card">
                    <h3>
                        <a href="{{ url_for('main.consultant_detail', profile_id=c.id) }}">
                            {{ c.display_name or c.display_name_masked }}
                        </a>
                    </h3>
                    <p class="mini-meta">
                        {% if c.specialisation %}{{ c.specialisation }}{% endif %}
                    </p>
                    <p class="mini-location">
                        {% if c.location_city or c.country %}
                            <i class="fas fa-map-marker-alt"></i>
                            {{ c.location_city }}{% if c.location_city and c.country %}, {% endif %}{{ c.country }}
                        {% else %}
                            &nbsp;
                        {% endif %}
                    </p>
                </article>
            {% endfor %}
        </div>
    </section>
    {% endif %}

    {# CONSULTANT ‚Üí vooral recent VACATURES tonen #}
    {% if session.get('role') == 'consultant' and latest_jobs %}
    <section class="home-list-section">
        <h2>Recent toegevoegde vacatures</h2>
        <div class="home-list-grid">
            {% for job in latest_jobs %}
                <article class="mini-card">
                    <h3>
                        <a href="{{ url_for('main.job_detail', job_id=job.id) }}">
                            {{ job.title }}
                        </a>
                    </h3>
                    {% if job.company %}
                        <p class="mini-meta">{{ job.company.company_name_masked }}</p>
                    {% endif %}
                    <p class="mini-location">
                        {% if job.location_city or job.country %}
                            <i class="fas fa-map-marker-alt"></i>
                            {{ job.location_city }}{% if job.location_city and job.country %}, {% endif %}{{ job.country }}
                        {% else %}
                            &nbsp;
                        {% endif %}
                    </p>
                </article>
            {% endfor %}
        </div>
    </section>
    {% endif %}
{% endif %}

{# RECENTE UNLOCKS (ALTIJD ZICHTBAAR, MAAR ANONIEM / GEBLURRED) #}
{% if recent_unlocks %}
<section class="home-list-section">
    <h2>Recent vrijgegeven profielen (geanonimiseerd)</h2>
    <p class="home-muted">
        Onderstaande items tonen enkel type en locatie. De echte contactgegevens zijn alleen zichtbaar
        voor de partij die het profiel heeft vrijgegeven.
    </p>
    <div class="home-list-grid">
        {% for u in recent_unlocks %}
            <article class="mini-card blurred-card">
                <div class="blur-inner">
                    {% if u.kind == 'consultant' %}
                        <h3>Consultant-profiel</h3>
                        <p class="mini-meta">
                            {% if u.profile.specialisation %}
                                {{ u.profile.specialisation }}
                            {% else %}
                                Consultant
                            {% endif %}
                        </p>
                        <p class="mini-location">
                            {% if u.profile.location_city or u.profile.country %}
                                <i class="fas fa-map-marker-alt"></i>
                                {{ u.profile.location_city }}{% if u.profile.location_city and u.profile.country %}, {% endif %}{{ u.profile.country }}
                            {% else %}
                                Locatie verborgen
                            {% endif %}
                        </p>
                    {% elif u.kind == 'job' %}
                        <h3>Vacature</h3>
                        <p class="mini-meta">
                            {% if u.job.contract_type %}
                                {{ u.job.contract_type }}
                            {% else %}
                                Job
                            {% endif %}
                        </p>
                        <p class="mini-location">
                            {% if u.job.location_city or u.job.country %}
                                <i class="fas fa-map-marker-alt"></i>
                                {{ u.job.location_city }}{% if u.job.location_city and u.job.country %}, {% endif %}{{ u.job.country }}
                            {% else %}
                                Locatie verborgen
                            {% endif %}
                        </p>
                    {% endif %}
                    <p class="mini-date">
                        {% if u.created_at_str %}Vrijgegeven op {{ u.created_at_str }}{% endif %}
                    </p>
                </div>
                <div class="blur-overlay">
                    üîí Details enkel zichtbaar voor de koper
                </div>
            </article>
        {% endfor %}
    </div>
</section>
{% endif %}

{# ONDERSTE UITLEG ‚Äì ROLSPECIFIEKE TIPS #}
<section class="home-explainer">
    <h2>Hoe werkt de IConsult-matchscore?</h2>
    <div class="home-explainer-grid">
        <div>
            <h3>Wat we meenemen in de score</h3>
            <ul>
                <li><strong>Skills</strong> ‚Äì hoe beter de gevraagde en aangeboden vaardigheden overeenkomen, hoe hoger de score.</li>
                <li><strong>Zoekterm</strong> ‚Äì indien u een zoekterm ingeeft, kijken we of die voorkomt in titel, samenvatting of beschrijving.</li>
                <li><strong>Recentheid</strong> ‚Äì recent toegevoegde of ge√ºpdatete profielen en vacatures krijgen een lichte boost.</li>
                <li><strong>Populariteit</strong> ‚Äì profielen en vacatures die vaker worden geunlockt, scoren iets hoger.</li>
            </ul>
        </div>

        <div class="home-tips">
            {# NIET INGELOGD ‚Üí BEIDE TIPSETS #}
            {% if not session.get('user_id') %}
                <p><strong>Voor bedrijven:</strong></p>
                <ul>
                    <li>Voeg duidelijke skills toe aan elke vacature.</li>
                    <li>Gebruik concrete termen in de titel en omschrijving.</li>
                </ul>
                <p><strong>Voor consultants:</strong></p>
                <ul>
                    <li>Vul je skills en specialisatie zo volledig mogelijk in.</li>
                    <li>Hou je profiel up-to-date, vooral bij nieuwe opdrachten.</li>
                </ul>

            {# COMPANY ‚Üí ENKEL BEDRIJFSTIPS #}
            {% elif session.get('role') == 'company' %}
                <p><strong>Optimaliseer als bedrijf:</strong></p>
                <ul>
                    <li>Definieer 3‚Äì7 kernskills per vacature voor een scherpere match.</li>
                    <li>Gebruik herkenbare functietitels en vermijd interne jargon.</li>
                    <li>Werk vacatures bij als requirements wijzigen, zodat de recentheidsscore behouden blijft.</li>
                </ul>

            {# CONSULTANT ‚Üí ENKEL CONSULTANTTIPS #}
            {% elif session.get('role') == 'consultant' %}
                <p><strong>Optimaliseer als consultant:</strong></p>
                <ul>
                    <li>Vul al je relevante skills in en update ze na elke opdracht.</li>
                    <li>Zorg dat je titel en korte bio je kernexpertise helder verwoorden.</li>
                    <li>Blijf actief: recent bijgewerkte profielen worden iets hoger gerankt.</li>
                </ul>
            {% endif %}
        </div>
    </div>
</section>

<style>
.home-hero {
    text-align: center;
    margin-top: 30px;
    margin-bottom: 30px;
}
.home-hero h1 {
    font-size: 2.4rem;
    margin-bottom: 10px;
}
.home-subtitle {
    font-size: 1.05rem;
    color: #4b5563;
    max-width: 600px;
    margin: 0 auto 20px auto;
}
.home-cta-row {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
}
.home-btn {
    display: inline-block;
    padding: 10px 20px;
    border-radius: 999px;
    font-weight: 600;
    text-decoration: none;
    border: 1px solid transparent;
}
.home-btn.primary {
    background: #2563eb;
    color: #fff;
    border-color: #1d4ed8;
}
.home-btn.primary:hover {
    background: #1d4ed8;
}
.home-btn.secondary {
    background: #e5e7eb;
    color: #111827;
    border-color: #d1d5db;
}
.home-btn.secondary:hover {
    background: #d1d5db;
}
.home-small {
    font-size: 0.9rem;
    color: #6b7280;
}

/* metrics */
.home-metrics {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 16px;
    margin-bottom: 30px;
}
.metric-card {
    background: #ffffff;
    border-radius: 12px;
    border: 1px solid #e5e7eb;
    padding: 14px 16px;
    box-shadow: 0 3px 8px rgba(15, 23, 42, 0.06);
}
.metric-label {
    font-size: 0.85rem;
    text-transform: uppercase;
    letter-spacing: 0.06em;
    color: #6b7280;
}
.metric-value {
    display: block;
    margin-top: 4px;
    font-size: 1.6rem;
    font-weight: 700;
    color: #111827;
}
.metric-hint {
    display: block;
    margin-top: 4px;
    font-size: 0.9rem;
    color: #6b7280;
}

/* columns blok */
.home-columns {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    gap: 20px;
    margin-top: 10px;
    margin-bottom: 30px;
}
.home-column {
    background: #ffffff;
    border-radius: 12px;
    border: 1px solid #e5e7eb;
    padding: 18px 18px 16px 18px;
}
.home-column h2 {
    margin-top: 0;
    margin-bottom: 10px;
}
.home-column ul {
    padding-left: 18px;
    margin-top: 0;
    margin-bottom: 10px;
}
.home-column li {
    margin-bottom: 6px;
    font-size: 0.95rem;
}
.home-link {
    font-size: 0.9rem;
    text-decoration: none;
    color: #2563eb;
    font-weight: 600;
}
.home-link:hover {
    text-decoration: underline;
}

/* lijsten recent jobs / consultants / unlocks */
.home-list-section {
    margin-bottom: 30px;
}
.home-list-section h2 {
    margin-bottom: 8px;
}
.home-muted {
    font-size: 0.9rem;
    color: #6b7280;
    margin-bottom: 10px;
}
.home-list-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(230px, 1fr));
    gap: 14px;
}
.mini-card {
    background: #ffffff;
    border-radius: 10px;
    border: 1px solid #e5e7eb;
    padding: 12px 14px;
    position: relative;
    overflow: hidden;
}
.mini-card h3 {
    margin: 0 0 4px 0;
    font-size: 1rem;
}
.mini-card h3 a {
    color: #1f2937;
    text-decoration: none;
}
.mini-card h3 a:hover {
    color: #2563eb;
}
.mini-meta {
    margin: 0 0 4px 0;
    font-size: 0.9rem;
    color: #4b5563;
}
.mini-location {
    margin: 0;
    font-size: 0.85rem;
    color: #6b7280;
}
.mini-location i {
    margin-right: 4px;
}
.mini-date {
    margin: 6px 0 0 0;
    font-size: 0.8rem;
    color: #9ca3af;
}

/* geblurde unlocks */
.blurred-card .blur-inner {
    filter: blur(3px);
    opacity: 0.8;
}
.blur-overlay {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    font-size: 0.85rem;
    font-weight: 600;
    color: #111827;
    background: rgba(249, 250, 251, 0.9);
    padding: 6px;
}

/* uitleg matchscore */
.home-explainer {
    margin: 20px 0 10px 0;
    padding: 18px 18px 16px 18px;
    border-radius: 12px;
    border: 1px solid #e5e7eb;
    background: #f9fafb;
}
.home-explainer h2 {
    margin-top: 0;
    margin-bottom: 10px;
}
.home-explainer-grid {
    display: grid;
    grid-template-columns: minmax(0, 2fr) minmax(0, 1.4fr);
    gap: 18px;
}
.home-explainer-grid ul {
    padding-left: 18px;
}
.home-tips ul {
    padding-left: 18px;
    margin-bottom: 8px;
}
.home-tips p {
    margin: 4px 0;
}

@media (max-width: 768px) {
    .home-cta-row {
        flex-direction: column;
    }
    .home-explainer-grid {
        grid-template-columns: 1fr;
    }
}
</style>

{% endblock %}
