{% extends "base.html" %}
{% block title %}Dashboard{% endblock %}

{% block content %}
<h1>Dashboard</h1>

{% if user %}
    <p>Welcome, <strong>{{ user.username }}</strong>!</p>
{% endif %}

<div class="card">
    <h2>Profile Details</h2>

    <p><strong>Username:</strong> {{ user.username }}</p>
    <p><strong>Role:</strong> {{ user.role.value }}</p>

    {% if user.role == UserRole.consultant %}
        {% if profile.profile_image %}
            <img
                src="{{ profile.profile_image }}"
                alt="Profile Picture"
                style="width:140px;height:140px;border-radius:50%;object-fit:cover;margin-bottom:12px;"
            >
        {% else %}
            <img
                src="{{ url_for('static', filename='img/default-avatar.png') }}"
                alt="No profile picture"
                style="width:140px;height:140px;border-radius:50%;object-fit:cover;margin-bottom:12px;"
            >
        {% endif %}

        {% if profile.cv_document %}
            <p>
                <strong>CV:</strong>
                <a href="{{ profile.cv_document }}" target="_blank">
                    View / download CV
                </a>
            </p>
        {% else %}
            <p><strong>CV:</strong> Not yet added</p>
        {% endif %}

        <p><strong>Name:</strong> {{ profile.display_name_masked }}</p>
        <p><strong>Location:</strong> {{ profile.location_city }} , {{ profile.country }}</p>
        <p><strong>Headline:</strong> {{ profile.headline or "No headline" }}</p>

        <p><strong>Email address:</strong> {{ profile.contact_email or "Not filled in" }}</p>
        <p><strong>Phone number:</strong> {{ profile.phone_number or "Not filled in" }}</p>

        <p><strong>Skills:</strong>
            {% if profile.skills %}
                {{ profile.skills | map(attribute='name') | join(', ') }}
            {% else %}
                No skills selected
            {% endif %}
        </p>

        <p>
            <strong>Availability:</strong>
            {% if profile.availability %}
                <span style="color: #28a745;">Available for new jobs</span>
            {% else %}
                <span style="color: #e24b4b;">Unavailable</span>
            {% endif %}
        </p>

        <a class="btn" href="{{ url_for('main.edit_consultant_skills') }}">Edit Skills</a>
        <a class="btn" href="{{ url_for('main.edit_consultant_profile') }}">Edit Profile</a>

    {% endif %}

    {% if user.role == UserRole.company %}
        <p><strong>Company name:</strong> {{ company.company_name_masked }}</p>
        <p><strong>Sector:</strong> {{ company.industry or "Not filled in" }}</p>

        <p><strong>Email address:</strong> {{ company.contact_email or "Not filled in" }}</p>
        <p><strong>Phone number:</strong> {{ company.phone_number or "Not filled in" }}</p>
        <a class="btn" href="{{ url_for('main.job_new') }}">New Job Post</a>
        <a href="{{ url_for('main.company_jobs_list') }}">My Job Posts</a>

        <a class="btn" href="{{ url_for('main.edit_company_profile') }}">Edit Profile</a>
    {% endif %}
</div>
{% endblock %}